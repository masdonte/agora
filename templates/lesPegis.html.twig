{# 
 # Template de gestion des classifications PEGI
 #
 # Fonctionnalités :
 # - Affichage de la liste des classifications PEGI
 # - Ajout d'une nouvelle classification PEGI
 # - Modification d'une classification existante
 # - Suppression d'une classification
 #
 # PEGI (Pan European Game Information) est le système européen 
 # de classification par âge des jeux vidéo
 #}

{% extends "base.html.twig" %}

{% block central %}
    {# Section principale de gestion des PEGI #}
    <div class="col-sm-6">
        <section class="panel">
            {# En-tête du panneau #}
            <div class="chat-room-head">
                <h3><i class="fa fa-angle-right"></i> Gérer les pegis</h3>
            </div>

            {# Corps du panneau #}
            <div class="panel-body">
                {# Tableau des classifications PEGI #}
                <table class="table table-striped table-advance table-hover">
                    <thead>
                        <tr class="tableau-entete">
                            <th><i class="fa fa-bullhorn"></i> Identifiant</th>
                            <th><i class="fas fa-hashtag"></i> Age minimum</th>
                            <th><i class="fas fa-users"></i> Description</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        {# Formulaire d'ajout d'une nouvelle classification PEGI #}
                        <tr>
                            <form action="index.php?uc=gererPegis" method="post">
                                {# Cellule d'identifiant (nouveau) #}
                                <td>Nouveau</td>

                                {# Champ de saisie de l'âge minimum #}
                                <td>
                                    <input type="text" 
                                           id="txtAge" 
                                           name="txtAge" 
                                           size="4" 
                                           required 
                                           placeholder="Âge" />
                                </td>

                                {# Champ de saisie de la description #}
                                <td>
                                    <input type="text" 
                                           id="txtDescription" 
                                           name="txtDescription" 
                                           size="24" 
                                           required 
                                           placeholder="Description" />
                                </td>

                                {# Boutons d'action pour l'ajout #}
                                <td>
                                    <button class="btn btn-primary btn-xs" 
                                            type="submit" 
                                            name="cmdAction" 
                                            value="ajouterNouveauPegi" 
                                            title="Enregistrer nouveau pegi">
                                        <i class="fa fa-save"></i>
                                    </button>
                                    <button class="btn btn-info btn-xs" 
                                            type="reset" 
                                            title="Effacer la saisie">
                                        <i class="fa fa-eraser"></i>
                                    </button>
                                </td>
                            </form>
                        </tr>
                        {# Boucle d'affichage des classifications PEGI existantes #}
                        {% for pegi in tbPegis %}
                            <tr>
                                <form action="index.php?uc=gererPegis" method="post" style="display: contents;">
                                    {# ID du PEGI (champ caché) #}
                                    <input type="hidden" 
                                           name="txtIdPegi" 
                                           value="{{ pegi.identifiant }}" />

                                    {# Affichage de l'identifiant #}
                                    <td>{{ pegi.identifiant }}</td>

                                    {# Mode affichage normal ou édition #}
                                    {% if pegi.identifiant != idPegiModif %}
                                        {# Mode affichage normal #}
                                        <td>{{ pegi.age }}</td>
                                        <td>{{ pegi.description }}</td>
                                        <td>
                                            {# Affichage de la notification si présente #}
                                            {% if notification != 'rien' and idPegiNotif is defined and pegi.identifiant == idPegiNotif %}
                                                <button class="btn btn-success btn-xs">
                                                    <i class="fa fa-check"></i> {{ notification }}
                                                </button>
                                            {% endif %}

                                            {# Boutons d'action en mode affichage #}
                                            <button class="btn btn-primary btn-xs" 
                                                    type="submit" 
                                                    name="cmdAction" 
                                                    value="demanderModifierPegi" 
                                                    title="Modifier">
                                                <i class="fa fa-pencil"></i>
                                            </button>
                                            <button class="btn btn-danger btn-xs" 
                                                    type="submit" 
                                                    name="cmdAction" 
                                                    value="supprimerPegi" 
                                                    title="Supprimer" 
                                                    onclick="return confirm('Voulez-vous vraiment supprimer ce pegi?');">
                                                <i class="fa fa-trash-o"></i>
                                            </button>
                                        </td>
                                    {% else %}
                                        {# Mode édition #}
                                        <td>
                                            <input type="text" 
                                                   name="txtAge" 
                                                   size="4" 
                                                   required 
                                                   value="{{ pegi.age }}" />
                                        </td>
                                        <td>
                                            <input type="text" 
                                                   name="txtDescription" 
                                                   size="24" 
                                                   required 
                                                   value="{{ pegi.description }}" />
                                        </td>
                                        <td>
                                            {# Boutons d'action en mode édition #}
                                            <button class="btn btn-primary btn-xs" 
                                                    type="submit" 
                                                    name="cmdAction" 
                                                    value="validerModifierPegi" 
                                                    title="Enregistrer">
                                                <i class="fa fa-save"></i>
                                            </button>
                                            <button class="btn btn-info btn-xs" 
                                                    type="reset" 
                                                    title="Effacer la saisie">
                                                <i class="fa fa-eraser"></i>
                                            </button>
                                            <button class="btn btn-warning btn-xs" 
                                                    type="submit" 
                                                    name="cmdAction" 
                                                    value="annulerModifierPegi" 
                                                    title="Annuler">
                                                <i class="fa fa-undo"></i>
                                            </button>
                                        </td>
                                    {% endif %}
                                </form>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>{# Fin du corps du panneau #}
        </section>{# Fin de la section des PEGI #}
    </div>{# Fin de la colonne #}
{% endblock %}


