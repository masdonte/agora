{% extends "base.html.twig" %}
{% block central %}
	<!-- page start-->
	<div class="col-sm-12">
		<section class="panel">
			<div class="chat-room-head">
				<h3>
					<i class="fa fa-angle-right"></i>
					Gérer les jeux vidéos</h3>
			</div>
			<div class="panel-body">
				<table class="table table-striped table-advance table-hover">
					<thead>
						<tr class="tableau-entete">
							<th>
								<i class="fa fa-barcode"></i>
								Référence</th>
							<th>
								<i class="fa fa-gamepad"></i>
								Nom</th>
							<th>
								<i class="fa fa-bookmark"></i>
								Marque</th>
							<th>
								<i class="fa fa-tag"></i>
								Genre</th>
							<th>
								<i class="fa fa-desktop"></i>
								Plateforme</th>
							<th>
								<i class="fa fa-child"></i>
								PEGI</th>
							<th>
								<i class="fa fa-euro"></i>
								Prix</th>
							<th>
								<i class="fa fa-calendar"></i>
								Date</th>
							<th></th>
						</tr>
					</thead>
					<tbody>
						{{ include('messages.html.twig') }}
						<!-- formulaire pour ajouter un nouveau jeu-->
						<tr>
							<form action="{{path('jeux_ajouter')}}" method="post">
								<td>
									<input type="text" id="txtRefJeu" name="txtRefJeu" size="12" required minlength="3" maxlength="16" placeholder="Réf" title="De 3 à 16 caractères"/>
								</td>
								<td>
									<input type="text" id="txtNomJeu" name="txtNomJeu" size="20" required minlength="3" maxlength="100" placeholder="Nom du jeu" title="De 3 à 100 caractères"/>
								</td>
								<td>
									<select id="lstMarque" name="lstMarque" required>
										<option value="">--Choisir--</option>
										{% for marque in tbMarques %}
											<option value="{{ marque.nom }}">{{ marque.nom }}</option>
										{% endfor %}
									</select>
								</td>
								<td>
									<select id="lstGenre" name="lstGenre" required>
										<option value="">--Choisir--</option>
										{% for genre in tbGenres %}
											<option value="{{ genre.libelle }}">{{ genre.libelle }}</option>
										{% endfor %}
									</select>
								</td>
								<td>
									<select id="lstPlateforme" name="lstPlateforme" required>
										<option value="">--Choisir--</option>
										{% for plateforme in tbPlateformes %}
											<option value="{{ plateforme.libelle }}">{{ plateforme.libelle }}</option>
										{% endfor %}
									</select>
								</td>
								<td>
									<select id="lstPegi" name="lstPegi" required>
										<option value="">--Choisir--</option>
										{% for pegi in tbPegis %}
											<option value="{{ pegi.ageLimite }}">{{ pegi.ageLimite }}</option>
										{% endfor %}
									</select>
								</td>
								<td>
									<input type="number" 
                                           id="txtPrixJeu" 
                                           name="txtPrixJeu" 
                                           size="6" 
                                           required 
                                           min="0.01" 
                                           max="999.99" 
                                           step="0.01"
                                           placeholder="Prix" 
                                           title="Prix en €"/>
								</td>
								<td>
									<input type="date" id="txtDateParutionJeu" name="txtDateParutionJeu" required title="Date de parution"/>
								</td>
								<td>
									<button class="btn btn-primary btn-xs" type="submit" name="cmdAction" value="ajouterNouveauJeu" title="Enregistrer nouveau jeu">
										<i class="fa fa-save save"></i>
									</button>
									<button class="btn btn-info btn-xs" type="reset" title="Effacer la saisie">
										<i class="fa fa-eraser"></i>
									</button>
								</td>
							</form>
						</tr>
						{% for key, jeu in tbJeux %}
							<tr>
								<!-- formulaire pour demander la modification et supprimer les jeux-->
								<form method="post">
									<input type="hidden" name="txtRefJeu" value="{{ jeu.identifiant }}"/>
									<td>
										{{ jeu.identifiant }}
									</td>
									{% if jeu.identifiant != refJeuModif %}
										<td>{{ jeu.nom }}</td>
										<td>{{ jeu.marque }}</td>
										<td>{{ jeu.genre }}</td>
										<td>{{ jeu.plateforme }}</td>
										<td>{{ jeu.pegi }}</td>
										<td>{{ jeu.prix }} €</td>
										<td>{{ jeu.dateParution|date('d/m/Y') }}</td>
										<td>
											{% if notification != 'rien' and jeu.identifiant == refJeuNotif %}
												<button class="btn btn-success btn-xs">
													<i class="fa fa-save check"></i>
													{{ notification }}</button>
											{% endif %}
											<button class="btn btn-primary btn-xs" type="submit" name="cmdAction" value="demanderModifierJeu" title="Modifier" formaction="{{path('jeux_demandermodifier')}}">
												<i class="fa fa-pencil"></i>
											</button>
											<button class="btn btn-danger btn-xs" type="submit" name="cmdAction" value="supprimerJeu" title="Supprimer" formaction="{{path('jeux_supprimer')}}" 
												onclick="return confirm('Voulez-vous vraiment supprimer ce jeu ?');">
												<i class="fa fa-trash-o "></i>
											</button>
										</td>
									{% else %}
										<td>
											<input type="text" id="txtNomJeu" name="txtNomJeu" size="20" required minlength="3" maxlength="100" value="{{ jeu.nom }}"/>
										</td>
										<td>
											<select id="lstMarque" name="lstMarque" required>
												{% for marque in tbMarques %}
													<option value="{{ marque.nom }}" {% if marque.nom == jeu.marque %}selected{% endif %}>{{ marque.nom }}</option>
												{% endfor %}
											</select>
										</td>
										<td>
											<select id="lstGenre" name="lstGenre" required>
												{% for genre in tbGenres %}
													<option value="{{ genre.libelle }}" {% if genre.libelle == jeu.genre %}selected{% endif %}>{{ genre.libelle }}</option>
												{% endfor %}
											</select>
										</td>
										<td>
											<select id="lstPlateforme" name="lstPlateforme" required>
												{% for plateforme in tbPlateformes %}
													<option value="{{ plateforme.libelle }}" {% if plateforme.libelle == jeu.plateforme %}selected{% endif %}>{{ plateforme.libelle }}</option>
												{% endfor %}
											</select>
										</td>
										<td>
											<select id="lstPegi" name="lstPegi" required>
												{% for pegi in tbPegis %}
													<option value="{{ pegi.ageLimite }}" {% if pegi.ageLimite == jeu.pegi %}selected{% endif %}>{{ pegi.ageLimite }}</option>
												{% endfor %}
											</select>
										</td>
										<td>
											<input type="number" 
                                                   id="txtPrixJeu" 
                                                   name="txtPrixJeu" 
                                                   size="6" 
                                                   required 
                                                   min="0.01" 
                                                   max="999.99" 
                                                   step="0.01"
                                                   value="{{ jeu.prix }}"/>
										</td>
										<td>
											<input type="date" id="txtDateParutionJeu" name="txtDateParutionJeu" required value="{{ jeu.dateParution|date('Y-m-d') }}"/>
										</td>
										<td>
											<button class="btn btn-primary btn-xs" type="submit" name="cmdAction" value="validerModifierJeu" title="Enregistrer" formaction="{{path('jeux_validermodifier')}}">
												<i class="fa fa-save"></i>
											</button>
											<button class="btn btn-info btn-xs" type="reset" title="Effacer la saisie">
												<i class="fa fa-eraser"></i>
											</button>
											<button class="btn btn-warning btn-xs" type="submit" name="cmdAction" value="annulerModifierJeu" title="Annuler" formaction="{{path('jeux_afficher')}}">
												<i class="fa fa-undo"></i>
											</button>
										</td>
									{% endif %}
								</form>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
			<!-- fin div panel-body-->
		</section>
		<!-- fin section jeux-->
	</div>
	<!--fin div col-sm-12-->
{% endblock %}